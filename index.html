<!DOCTYPE html>
<html>
<head>
    <title>cmdFreeCOM</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            background: #121212;
            color: #00ff00;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            text-align: center;
        }
        /* ... (остальные стили остаются такими же) ... */
    </style>
</head>
<body>
    <!-- ... (прежний HTML-код) ... -->

    <script>
        // Новые переменные для расширенных функций
        const todoList = JSON.parse(localStorage.getItem('todo')) || [];
        let calculatorMode = false;
        let riddleAnswer = null;

        function runCommand() {
            const input = document.getElementById("command-input");
            const command = input.value.trim().toLowerCase();
            const output = document.getElementById("output");

            let result = "";

            // ======== НОВЫЕ КОМАНДЫ ======== //
            
            /* 1. Калькулятор */
            if (calculatorMode) {
                try {
                    result = `= ${eval(command)}`;
                } catch {
                    result = "Ошибка в выражении";
                }
                calculatorMode = false;
            } 
            else if (command === "calc") {
                calculatorMode = true;
                result = "Режим калькулятора. Введите выражение:";
            }
            
            /* 2. Список дел */
            else if (command === "todo") {
                result = todoList.length ? todoList.map((t,i) => `${i+1}. ${t}`).join('\n') : "Список пуст!";
            }
            else if (command.startsWith("add ")) {
                const task = command.substring(4);
                todoList.push(task);
                localStorage.setItem('todo', JSON.stringify(todoList));
                result = `Добавлено: "${task}"`;
            }
            else if (command.startsWith("del ")) {
                const index = parseInt(command.substring(4)) - 1;
                if (index >= 0 && index < todoList.length) {
                    result = `Удалено: "${todoList.splice(index, 1)[0]}"`;
                    localStorage.setItem('todo', JSON.stringify(todoList));
                } else {
                    result = "Неверный номер задачи";
                }
            }
            
            /* 3. Викторина */
            else if (command === "quiz") {
                const questions = [
                    {q: "Какой язык начинается с 'P' и заканчивается на 'n'?", a: "python"},
                    {q: "Сколько бит в байте?", a: "8"}
                ];
                const current = questions[Math.floor(Math.random()*questions.length)];
                riddleAnswer = current.a;
                result = `Вопрос: ${current.q}\n(Ответь "answer ваш_ответ")`;
            }
            else if (command.startsWith("answer ")) {
                const answer = command.substring(7);
                result = answer === riddleAnswer ? "✅ Верно!" : "❌ Неверно!";
                riddleAnswer = null;
            }
            
            /* 4. Дополнительные развлечения */
            else if (command === "dice") {
                result = `Выпало: ${Math.floor(Math.random()*6)+1}`;
            }
            else if (command === "bored") {
                fetch('https://www.boredapi.com/api/activity')
                    .then(r => r.json())
                    .then(data => result = `Совет: ${data.activity}`);
            }
            else if (command === "quote") {
                fetch('https://api.quotable.io/random')
                    .then(r => r.json())
                    .then(data => result = `"${data.content}"\n— ${data.author}`);
            }
            
            /* 5. Системные команды */
            else if (command === "theme dark") {
                document.body.style.backgroundColor = '#121212';
                document.body.style.color = '#00ff00';
                result = "Тёмная тема включена";
            }
            else if (command === "theme light") {
                document.body.style.backgroundColor = '#f0f0f0';
                document.body.style.color = '#333';
                result = "Светлая тема включена";
            }
            
            // ======== ПРЕЖНИЕ КОМАНДЫ ======== //
            else if (command === "bonscik3d") { /* ... */ }
            else if (command === "help") {
                result = `Доступные команды:\n` +
                `- calc: калькулятор\n` +
                `- todo: список дел\n` +
                `- add [задача]: добавить дело\n` +
                `- del [номер]: удалить дело\n` +
                `- quiz: викторина\n` +
                `- dice: бросить кубик\n` +
                `- bored: чем заняться?\n` +
                `- quote: случайная цитата\n` +
                `- theme [dark/light]: сменить тему\n` +
                `... и все предыдущие команды`;
            }
            // ... (остальные прежние команды)

            output.innerHTML = `<pre>${result}</pre>`;
            input.value = "";
        }
    </script>
</body>
</html>
